---
import { ViewTransitions } from "astro:transitions";
import "../styles/style.css";
---

<head>
   <ViewTransitions />
   <!-- Web3Forms hCaptcha script (optional, but recommended) -->
   <script src="https://web3forms.com/client/script.js" async defer></script>
</head>
<main class="contact-main">
   <section class="hero-section">
      <div class="container">
         <h1 class="section-title">ãŠå•ã„åˆã‚ã›</h1>
         <p class="section-subtitle">ã”é€£çµ¡ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚ã”è³ªå•ã‚„ãŠå•ã„åˆã‚ã›ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚</p>
      </div>
   </section>

   <section class="contact-section">
      <div class="container">
         <div class="contact-wrapper">
            <div class="contact-info">
               <div class="info-card">
                  <div class="info-icon">ğŸ“</div>
                  <h3>æ‰€åœ¨åœ°</h3>
                  <p>å››æ—¥å¸‚å¸‚è¥¿ç”º9-15-2</p>
                  <p>ä¸‰é‡, æ—¥æœ¬ 510-0089</p>
               </div>
               
               <div class="info-card">
                  <div class="info-icon">ğŸ“</div>
                  <h3>é›»è©±ç•ªå·</h3>
                  <p>+81 90-9221-5699</p>
               </div>
               
               <div class="info-card">
                  <div class="info-icon">âœ‰ï¸</div>
                  <h3>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</h3>
                  <p>higuchiyuya.riddle@gmail.com</p>
                  <p>higuchiyuya@he-ro.jp</p>
               </div>
               
               <div class="info-card">
                  <div class="info-icon">ğŸŒ</div>
                  <h3>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ¡ãƒ‡ã‚£ã‚¢</h3>
                  <div class="social-links">
                     <a href="#" class="social-link">Twitter</a>
                     <a href="#" class="social-link">Facebook</a>
                     <a href="#" class="social-link">Instagram</a>
                     <a href="#" class="social-link">LinkedIn</a>
                  </div>
               </div>
            </div>
            
            <div class="contact-form-container">
               <div class="form-header">
                  <h2>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹</h2>
                  <div class="progress-indicator">
                     <div class="step active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-label">åŸºæœ¬æƒ…å ±</span>
                     </div>
                     <div class="step" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-label">è©³ç´°</span>
                     </div>
                     <div class="step" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-label">ç¢ºèª</span>
                     </div>
                  </div>
               </div>

               <!-- Enhanced form with progressive disclosure -->
               <form action="https://api.web3forms.com/submit" method="POST" class="contact-form" id="contactForm" novalidate>
                  <!-- Hidden fields -->
                  <input type="hidden" name="access_key" value="b2eb3e61-368a-47c8-8f09-76d29a531253">
                  <input type="hidden" name="subject" value="ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‹ã‚‰ã®ãŠå•ã„åˆã‚ã›">
                  <input type="hidden" name="from_name" value="He-Ro Company Website">
                  <input type="hidden" name="replyto" data-form-input="email">
                  <input type="hidden" name="request_type" value="no_account_deletion">

                  <!-- Step 1: Basic Information -->
                  <div class="form-step active" data-step="1">
                     <div class="step-content">
                        <h3 class="step-title">åŸºæœ¬æƒ…å ±ã‚’ãŠæ•™ãˆãã ã•ã„</h3>
                        
                        <div class="form-group">
                           <label for="name" class="required">ãŠåå‰ <span class="required-mark">*</span></label>
                           <input type="text" id="name" name="name" required
                                  placeholder="å±±ç”° å¤ªéƒ"
                                  aria-describedby="name-error"
                                  autocomplete="name">
                           <div class="error-message" id="name-error" role="alert"></div>
                           <div class="success-message" id="name-success"></div>
                        </div>
                        
                        <div class="form-group">
                           <label for="email" class="required">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required-mark">*</span></label>
                           <input type="email" id="email" name="email" required
                                  placeholder="example@email.com"
                                  aria-describedby="email-error email-help"
                                  autocomplete="email">
                           <div class="help-text" id="email-help">è¿”ä¿¡ã«ã“ã¡ã‚‰ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™</div>
                           <div class="error-message" id="email-error" role="alert"></div>
                           <div class="success-message" id="email-success"></div>
                        </div>

                        <div class="form-group">
                           <label for="phone">é›»è©±ç•ªå·ï¼ˆä»»æ„ï¼‰</label>
                           <input type="tel" id="phone" name="phone"
                                  placeholder="090-1234-5678"
                                  aria-describedby="phone-error"
                                  autocomplete="tel">
                           <div class="error-message" id="phone-error" role="alert"></div>
                           <div class="success-message" id="phone-success"></div>
                        </div>
                     </div>

                     <div class="step-navigation">
                        <button type="button" class="btn btn-primary next-step" data-next="2">
                           æ¬¡ã¸ <span class="btn-icon">â†’</span>
                        </button>
                     </div>
                  </div>

                  <!-- Step 2: Details -->
                  <div class="form-step" data-step="2">
                     <div class="step-content">
                        <h3 class="step-title">ãŠå•ã„åˆã‚ã›è©³ç´°</h3>

                        <div class="form-group">
                           <label class="required">é–¢å¿ƒã®ã‚ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ <span class="required-mark">*</span></label>
                           <div class="service-cards">
                              <label class="service-card">
                                 <input type="radio" name="service" value="riddle" required>
                                 <div class="card-content">
                                    <div class="service-icon">ğŸ§©</div>
                                    <h4>Riddle</h4>
                                    <p>æ€è€ƒåŠ›ã‚’è§£ãæ”¾ã¤ãƒ‘ã‚ºãƒ«ã‚¢ãƒ—ãƒª</p>
                                 </div>
                              </label>
                              <label class="service-card">
                                 <input type="radio" name="service" value="prompty" required>
                                 <div class="card-content">
                                    <div class="service-icon">âœ¨</div>
                                    <h4>Prompty</h4>
                                    <p>AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«</p>
                                 </div>
                              </label>
                              <label class="service-card">
                                 <input type="radio" name="service" value="summaries" required>
                                 <div class="card-content">
                                    <div class="service-icon">ğŸ“š</div>
                                    <h4>Summaries</h4>
                                    <p>èª­æ›¸ä½“é¨“ã‚’å¤‰é©ã™ã‚‹ã‚¢ãƒ—ãƒª</p>
                                 </div>
                              </label>
                           </div>
                           <div class="error-message" id="service-error" role="alert"></div>
                        </div>

                        <div class="form-group">
                           <label for="inquiry-type" class="required">ãŠå•ã„åˆã‚ã›ç¨®åˆ¥ <span class="required-mark">*</span></label>
                           <select id="inquiry-type" name="inquiry_type" required aria-describedby="inquiry-type-error">
                              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                              <option value="general">ä¸€èˆ¬çš„ãªãŠå•ã„åˆã‚ã›</option>
                              <option value="technical">æŠ€è¡“çš„ãªå•é¡Œ</option>
                              <option value="feature">æ©Ÿèƒ½ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</option>
                              <option value="business">ãƒ“ã‚¸ãƒã‚¹é–¢é€£</option>
                              <option value="account">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–¢é€£</option>
                              <option value="other">ãã®ä»–</option>
                           </select>
                           <div class="error-message" id="inquiry-type-error" role="alert"></div>
                        </div>

                        <div class="form-group checkbox-group">
                           <label class="checkbox-label">
                              <input type="checkbox" id="account-deletion" name="account_deletion" value="yes">
                              <span class="checkmark"></span>
                              ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã‚’å¸Œæœ›ã™ã‚‹
                           </label>
                           <div class="help-text">ãƒã‚§ãƒƒã‚¯ã—ãŸå ´åˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã®æ‰‹ç¶šãã‚’ã”æ¡ˆå†…ã—ã¾ã™</div>
                        </div>
                     </div>

                     <div class="step-navigation">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="1">
                           <span class="btn-icon">â†</span> æˆ»ã‚‹
                        </button>
                        <button type="button" class="btn btn-primary next-step" data-next="3">
                           æ¬¡ã¸ <span class="btn-icon">â†’</span>
                        </button>
                     </div>
                  </div>

                  <!-- Step 3: Message and Confirmation -->
                  <div class="form-step" data-step="3">
                     <div class="step-content">
                        <h3 class="step-title">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹</h3>
                        
                        <div class="form-group">
                           <label for="subject_input" class="required">ä»¶å <span class="required-mark">*</span></label>
                           <input type="text" id="subject_input" name="subject_input" required
                                  placeholder="ä¾‹ï¼šã‚¢ãƒ—ãƒªã®ä½¿ã„æ–¹ã«ã¤ã„ã¦"
                                  aria-describedby="subject-error">
                           <div class="error-message" id="subject-error" role="alert"></div>
                           <div class="success-message" id="subject-success"></div>
                        </div>
                        
                        <div class="form-group">
                           <label for="message" class="required">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ <span class="required-mark">*</span></label>
                           <textarea id="message" name="message" rows="6" required
                                     placeholder="è©³ç´°ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãŠæ›¸ããã ã•ã„..."
                                     aria-describedby="message-error message-help"
                                     maxlength="2000"></textarea>
                           <div class="help-text" id="message-help">
                              <span class="char-count">0</span>/2000æ–‡å­—
                           </div>
                           <div class="error-message" id="message-error" role="alert"></div>
                           <div class="success-message" id="message-success"></div>
                        </div>

                        <div class="form-summary">
                           <h4>å…¥åŠ›å†…å®¹ã®ç¢ºèª</h4>
                           <div class="summary-content">
                              <!-- Dynamic content will be inserted here -->
                           </div>
                        </div>
                     </div>

                     <div class="step-navigation">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="2">
                           <span class="btn-icon">â†</span> æˆ»ã‚‹
                        </button>
                        <button type="submit" class="btn btn-success submit-button">
                           <span class="submit-icon">ğŸ“¤</span>
                           ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
                        </button>
                     </div>
                  </div>
               </form>

               <!-- Form status messages -->
               <div class="form-status" id="formStatus" role="status" aria-live="polite">
                  <div class="loading-message" id="loadingMessage">
                     <div class="spinner"></div>
                     <span>é€ä¿¡ä¸­...</span>
                  </div>
                  <div class="success-message-final" id="successMessage">
                     <div class="success-icon">âœ…</div>
                     <h3>é€ä¿¡å®Œäº†</h3>
                     <p>ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚24æ™‚é–“ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚</p>
                  </div>
                  <div class="error-message-final" id="errorMessage">
                     <div class="error-icon">âŒ</div>
                     <h3>é€ä¿¡ã‚¨ãƒ©ãƒ¼</h3>
                     <p>ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãçµŒã£ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </section>

   <section class="map-section">
      <div class="container">
         <h2 class="section-title">æ‰€åœ¨åœ°</h2>
         <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6538.723638879095!2d136.61882157563397!3d34.972600772824244!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60038ef76a2c9cdf%3A0x754624d94fc8dd56!2z44CSNTEwLTAwODkg5LiJ6YeN55yM5Zub5pel5biC5biC6KW_55S677yZ4oiS77yR77yV!5e0!3m2!1sja!2sjp!4v1755439357914!5m2!1sja!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
   </section>
</main>

<style>
   /* CSS Variables */
   :root {
      --primary-color: #6366f1;
      --primary-hover: #5048e5;
      --secondary-color: #f59e0b;
      --accent-color: #10b981;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --text-light: #9ca3af;
      --bg-primary: #ffffff;
      --bg-secondary: #f9fafb;
      --border-color: #e5e7eb;
      --error-color: #dc2626;
      --success-color: #059669;
      --warning-color: #d97706;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --border-radius-lg: 12px;
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
   }

   .contact-main {
      /* padding-topã¯global.cssã§çµ±ä¸€ç®¡ç† */
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.1) 0%,
         rgba(255, 255, 255, 0.05) 25%,
         rgba(240, 248, 255, 0.1) 50%,
         rgba(248, 250, 252, 0.05) 75%,
         rgba(255, 255, 255, 0.1) 100%);
      min-height: 100vh;
   }

   .section-title {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--text-primary);
      position: relative;
      display: inline-block;
      text-align: center;
      font-weight: 800;
      letter-spacing: -0.02em;
   }

   .section-title::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 50px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
   }

   .section-subtitle {
      font-size: 1.2rem;
      color: var(--text-secondary);
      max-width: 700px;
      margin: 0 auto 3rem;
      text-align: center;
      line-height: 1.6;
   }

   /* Hero Section */
   .hero-section {
      padding: 4rem 0 2rem;
      text-align: center;
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.25) 0%,
         rgba(240, 248, 255, 0.15) 50%,
         rgba(248, 250, 252, 0.25) 100%);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
   }

   /* Contact Section */
   .contact-section {
      padding: 4rem 0;
   }

   .contact-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 3rem;
      align-items: flex-start;
   }

   .contact-info {
      flex: 1;
      min-width: 300px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
   }

   .info-card {
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.25) 0%,
         rgba(255, 255, 255, 0.1) 100%);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 1.5rem;
      border-radius: var(--border-radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: var(--shadow-lg);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
   }

   .info-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.35) 0%,
         rgba(255, 255, 255, 0.15) 100%);
   }

   .info-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
      display: block;
   }

   .info-card h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--text-primary);
      font-weight: 600;
   }

   .info-card p {
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
      line-height: 1.5;
   }

   .social-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: flex-start;
   }

   .social-link {
      display: inline-block;
      padding: 0.5rem 1rem;
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.2) 0%,
         rgba(255, 255, 255, 0.05) 100%);
      color: var(--text-primary);
      border-radius: var(--border-radius);
      text-decoration: none;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      font-size: 0.9rem;
      font-weight: 500;
   }

   .social-link:hover {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
      color: white;
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
   }

   /* Enhanced Contact Form */
   .contact-form-container {
      flex: 1;
      min-width: 400px;
      background: linear-gradient(135deg,
         rgba(255, 255, 255, 0.25) 0%,
         rgba(255, 255, 255, 0.1) 50%,
         rgba(255, 255, 255, 0.25) 100%);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      padding: 2.5rem;
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 
         0 8px 32px rgba(0, 0, 0, 0.1),
         0 1px 0 rgba(255, 255, 255, 0.4) inset;
   }

   .form-header {
      margin-bottom: 2rem;
   }

   .form-header h2 {
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      color: var(--text-primary);
      text-align: center;
      font-weight: 700;
   }

   /* Progress Indicator */
   .progress-indicator {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
   }

   .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      border-radius: var(--border-radius);
      transition: all 0.3s ease;
      cursor: pointer;
   }

   .step.active {
      background: linear-gradient(135deg,
         rgba(99, 102, 241, 0.2) 0%,
         rgba(99, 102, 241, 0.1) 100%);
   }

   .step-number {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--border-color);
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.3s ease;
   }

   .step.active .step-number {
      background: var(--primary-color);
      color: white;
   }

   .step.completed .step-number {
      background: var(--success-color);
      color: white;
   }

   .step-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      font-weight: 500;
   }

   .step.active .step-label {
      color: var(--primary-color);
   }

   /* Form Steps */
   .contact-form {
      position: relative;
      min-height: 400px;
   }

   .form-step {
      display: none;
      animation: fadeInSlide 0.4s cubic-bezier(0.4, 0, 0.2, 1);
   }

   .form-step.active {
      display: block;
   }

   @keyframes fadeInSlide {
      from {
         opacity: 0;
         transform: translateX(20px);
      }
      to {
         opacity: 1;
         transform: translateX(0);
      }
   }

   .step-content {
      margin-bottom: 2rem;
   }

   .step-title {
      font-size: 1.4rem;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      font-weight: 600;
      text-align: center;
   }

   /* Form Groups and Inputs */
   .form-group {
      margin-bottom: 1.5rem;
   }

   .form-group label {
      display: block;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
   }

   .required-mark {
      color: var(--error-color);
      font-weight: 700;
   }

   .form-group input[type="text"],
   .form-group input[type="email"],
   .form-group input[type="tel"],
   .form-group select,
   .form-group textarea {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-sizing: border-box;
   }

   .form-group input:focus,
   .form-group select:focus,
   .form-group textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      background: rgba(255, 255, 255, 0.95);
   }

   .form-group input.valid,
   .form-group select.valid,
   .form-group textarea.valid {
      border-color: var(--success-color);
   }

   .form-group input.invalid,
   .form-group select.invalid,
   .form-group textarea.invalid {
      border-color: var(--error-color);
   }

   /* Service Cards */
   .service-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1rem;
      margin-top: 0.5rem;
   }

   .service-card {
      cursor: pointer;
      position: relative;
   }

   .service-card input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      margin: 0;
      cursor: pointer;
   }

   .card-content {
      padding: 1rem;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius);
      text-align: center;
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: all 0.3s ease;
   }

   .service-card:hover .card-content {
      border-color: var(--primary-color);
      background: rgba(255, 255, 255, 0.8);
      transform: translateY(-2px);
   }

   .service-card input:checked + .card-content {
      border-color: var(--primary-color);
      background: linear-gradient(135deg,
         rgba(99, 102, 241, 0.15) 0%,
         rgba(99, 102, 241, 0.05) 100%);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
   }

   .service-icon {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
   }

   .card-content h4 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
   }

   .card-content p {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin: 0;
      line-height: 1.3;
   }

   /* Checkbox Styling */
   .checkbox-group {
      margin-top: 1rem;
   }

   .checkbox-label {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      cursor: pointer;
      font-weight: normal;
      font-size: 0.95rem;
      line-height: 1.4;
   }

   .checkbox-label input[type="checkbox"] {
      position: absolute;
      opacity: 0;
   }

   .checkmark {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.8);
      position: relative;
      flex-shrink: 0;
      transition: all 0.3s ease;
   }

   .checkbox-label input:checked + .checkmark {
      background: var(--primary-color);
      border-color: var(--primary-color);
   }

   .checkbox-label input:checked + .checkmark::after {
      content: 'âœ“';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 12px;
      font-weight: bold;
   }

   /* Help Text and Messages */
   .help-text {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-top: 0.25rem;
      line-height: 1.4;
   }

   .char-count {
      font-weight: 600;
      

      color: var(--text-secondary);
   }

   .error-message {
      color: var(--error-color);
      font-size: 0.85rem;
      font-weight: 500;
      margin-top: 0.25rem;
      display: none;
   }

   .error-message.show {
      display: block;
   }

   .success-message {
      color: var(--success-color);
      font-size: 0.85rem;
      font-weight: 500;
      margin-top: 0.25rem;
      display: none;
   }

   .success-message.show {
      display: block;
   }

   /* Form Summary */
   .form-summary {
      background: rgba(255, 255, 255, 0.3);
      padding: 1rem;
      border-radius: var(--border-radius);
      border: 1px solid rgba(255, 255, 255, 0.3);
      margin-top: 1.5rem;
   }

   .form-summary h4 {
      font-size: 1rem;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
      font-weight: 600;
   }

   .summary-content {
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.5;
   }

   /* Navigation Buttons */
   .step-navigation {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin-top: 2rem;
   }

   .btn {
      padding: 0.875rem 1.5rem;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      min-height: 48px;
      justify-content: center;
   }

   .btn-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
      color: white;
      border: 2px solid var(--primary-color);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
   }

   .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
   }

   .btn-secondary {
      background: rgba(255, 255, 255, 0.8);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
   }

   .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.95);
      border-color: var(--primary-color);
      transform: translateY(-1px);
   }

   .btn-success {
      background: linear-gradient(135deg, var(--success-color), #047857);
      color: white;
      border: 2px solid var(--success-color);
      box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
   }

   .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(5, 150, 105, 0.4);
   }

   .btn:disabled {
      background: var(--border-color);
      color: var(--text-light);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
   }

   .btn-icon {
      font-size: 0.9rem;
   }

   .submit-icon {
      font-size: 1.1rem;
   }

   /* Form Status Messages */
   .form-status {
      margin-top: 2rem;
      text-align: center;
   }

   .form-status > div {
      display: none;
   }

   .form-status.loading .loading-message {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      color: var(--text-secondary);
   }

   .form-status.success .success-message-final {
      display: block;
   }

   .form-status.error .error-message-final {
      display: block;
   }

   .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-top: 2px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
   }

   @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
   }

   .success-message-final,
   .error-message-final {
      padding: 1.5rem;
      border-radius: var(--border-radius);
      margin-top: 1rem;
   }

   .success-message-final {
      background: linear-gradient(135deg,
         rgba(5, 150, 105, 0.1) 0%,
         rgba(5, 150, 105, 0.05) 100%);
      border: 1px solid rgba(5, 150, 105, 0.2);
   }

   .error-message-final {
      background: linear-gradient(135deg,
         rgba(220, 38, 38, 0.1) 0%,
         rgba(220, 38, 38, 0.05) 100%);
      border: 1px solid rgba(220, 38, 38, 0.2);
   }

   .success-icon,
   .error-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
   }

   .success-message-final h3,
   .error-message-final h3 {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
   }

   .success-message-final h3 {
      color: var(--success-color);
   }

   .error-message-final h3 {
      color: var(--error-color);
   }

   .success-message-final p,
   .error-message-final p {
      color: var(--text-secondary);
      margin: 0;
      line-height: 1.5;
   }

   /* Map Section */
   .map-section {
      padding: 4rem 0;
      background: linear-gradient(135deg,
         rgba(248, 250, 252, 0.3) 0%,
         rgba(241, 245, 249, 0.2) 50%,
         rgba(248, 250, 252, 0.3) 100%);
      text-align: center;
   }

   .map-container {
      margin-top: 2rem;
      border-radius: var(--border-radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
   }

   .map-placeholder {
      width: 100%;
      height: 400px;
      background-color: #e9e9e9;
      display: flex;
      align-items: center;
      justify-content: center;
   }

   .map-placeholder img {
      width: 100%;
      height: 100%;
      object-fit: cover;
   }

   /* Responsive styles */
   @media (max-width: 768px) {
      .section-title {
         font-size: 2rem;
      }

      .contact-wrapper {
         flex-direction: column;
         gap: 2rem;
      }

      .contact-info {
         grid-template-columns: 1fr;
      }

      .contact-form-container {
         min-width: auto;
         padding: 2rem;
         border-radius: 16px;
      }

      .service-cards {
         grid-template-columns: 1fr;
      }

      .step-navigation {
         flex-direction: column-reverse;
      }

      .btn {
         width: 100%;
         min-height: 52px;
      }
   }

   @media (max-width: 480px) {
      .section-title {
         font-size: 1.8rem;
      }

      .section-subtitle {
         font-size: 1rem;
      }

      .contact-form-container {
         padding: 1.5rem;
         border-radius: 12px;
      }

      .form-header h2 {
         font-size: 1.5rem;
      }

      .progress-indicator {
         gap: 0.5rem;
      }

      .step-number {
         width: 28px;
         height: 28px;
         font-size: 0.8rem;
      }

      .step-label {
         font-size: 0.7rem;
      }

      .map-container {
         height: 300px;
      }
   }
</style>

<script>
   // Enhanced form functionality with progressive disclosure
   document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('contactForm');
      const steps = document.querySelectorAll('.form-step');
      const progressSteps = document.querySelectorAll('.progress-indicator .step');
      const nextButtons = document.querySelectorAll('.next-step');
      const prevButtons = document.querySelectorAll('.prev-step');
      const formStatus = document.getElementById('formStatus');
      
      let currentStep = 1;
      const totalSteps = steps.length;
      const formData: any = {};

      // Initialize form
      showStep(currentStep);

      // Step navigation
      nextButtons.forEach(button => {
         button.addEventListener('click', function() {
            const nextStep = parseInt(button.getAttribute('data-next') || '1');
            if (validateCurrentStep()) {
               saveCurrentStepData();
               goToStep(nextStep);
            }
         });
      });

      prevButtons.forEach(button => {
         button.addEventListener('click', function() {
            const prevStep = parseInt(button.getAttribute('data-prev') || '1');
            goToStep(prevStep);
         });
      });

      // Real-time validation
      setupRealTimeValidation();

      // Character counter for textarea
      const messageField = document.getElementById('message');
      const charCount = document.querySelector('.char-count');
      
      if (messageField && charCount) {
         messageField.addEventListener('input', function() {
            charCount.textContent = String((this as HTMLTextAreaElement).value.length);
         });
      }

      // Form submission
      if (form) {
         form.addEventListener('submit', function(e) {
            e.preventDefault();
            if (validateCurrentStep()) {
               submitForm();
            }
         });
      }

      function showStep(stepNumber: number) {
         steps.forEach((step, index) => {
            step.classList.toggle('active', index + 1 === stepNumber);
         });

         progressSteps.forEach((step, index) => {
            const stepNum = index + 1;
            step.classList.toggle('active', stepNum === stepNumber);
            step.classList.toggle('completed', stepNum < stepNumber);
         });

         currentStep = stepNumber;

         // Update summary in step 3
         if (stepNumber === 3) {
            updateFormSummary();
         }
      }

      function goToStep(stepNumber: number) {
         if (stepNumber >= 1 && stepNumber <= totalSteps) {
            showStep(stepNumber);
         }
      }

      function validateCurrentStep() {
         const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
         if (!currentStepElement) return false;
         
         const requiredFields = currentStepElement.querySelectorAll('[required]');
         let isValid = true;

         requiredFields.forEach(field => {
            if (!validateField(field as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement)) {
               isValid = false;
            }
         });

         return isValid;
      }

      function validateField(field: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement) {
         const value = field.value.trim();
         const fieldName = field.name;
         let isValid = true;
         let errorMessage = '';

         // Clear previous states
         field.classList.remove('valid', 'invalid');
         hideFieldMessage(field, 'error');
         hideFieldMessage(field, 'success');

         // Required field validation
         if (field.hasAttribute('required') && !value) {
            errorMessage = 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™';
            isValid = false;
         }
         
         // Email validation
         else if (field.type === 'email' && value) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(value)) {
               errorMessage = 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
               isValid = false;
            }
         }
         
         // Phone validation (optional but if provided, should be valid)
         else if (field.type === 'tel' && value) {
            const phoneRegex = /^[\d\-\(\)\+\s]+$/;
            if (!phoneRegex.test(value)) {
               errorMessage = 'æœ‰åŠ¹ãªé›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
               isValid = false;
            }
         }

         // Radio button validation for services
         else if (field.type === 'radio' && field.name === 'service') {
            const checkedService = document.querySelector('input[name="service"]:checked');
            if (!checkedService) {
               errorMessage = 'ã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„';
               isValid = false;
            }
         }

         // Apply validation result
         if (isValid) {
            field.classList.add('valid');
            if (value) {
               showFieldMessage(field, 'success', 'âœ“');
            }
         } else {
            field.classList.add('invalid');
            showFieldMessage(field, 'error', errorMessage);
         }

         return isValid;
      }

      function showFieldMessage(field: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement, type: string, message: string) {
         const messageElement = document.getElementById(`${field.id || field.name}-${type}`);
         if (messageElement) {
            messageElement.textContent = message;
            messageElement.classList.add('show');
         }
      }

      function hideFieldMessage(field: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement, type: string) {
         const messageElement = document.getElementById(`${field.id || field.name}-${type}`);
         if (messageElement) {
            messageElement.classList.remove('show');
         }
      }

      function setupRealTimeValidation() {
         if (!form) return;
         const inputs = form.querySelectorAll('input, select, textarea');
         inputs.forEach(input => {
            input.addEventListener('blur', () => validateField(input as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement));
            input.addEventListener('input', () => {
               if (input.classList.contains('invalid')) {
                  validateField(input as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement);
               }
            });
         });

         // Service selection validation
         const serviceInputs = document.querySelectorAll('input[name="service"]');
         serviceInputs.forEach(input => {
            input.addEventListener('change', function() {
               hideFieldMessage({ name: 'service' } as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement, 'error');
            });
         });
      }

      function saveCurrentStepData() {
         const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
         if (!currentStepElement) return;
         
         const inputs = currentStepElement.querySelectorAll('input, select, textarea');
         
         inputs.forEach(input => {
            const inputElement = input as any;
            if (inputElement.type === 'radio') {
               if (inputElement.checked) {
                  formData[inputElement.name] = inputElement.value;
               }
            } else if (inputElement.type === 'checkbox') {
               formData[inputElement.name] = inputElement.checked;
            } else {
               formData[inputElement.name] = inputElement.value;
            }
         });
      }

      function updateFormSummary() {
         const summaryContent = document.querySelector('.summary-content');
         if (!summaryContent) return;
         
         let html = '';

         if (formData.name) html += `<p><strong>ãŠåå‰:</strong> ${formData.name}</p>`;
         if (formData.email) html += `<p><strong>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</strong> ${formData.email}</p>`;
         if (formData.phone) html += `<p><strong>é›»è©±ç•ªå·:</strong> ${formData.phone}</p>`;
         if (formData.service) {
            const serviceNames: { [key: string]: string } = {
               'riddle': 'Riddle',
               'prompty': 'Prompty',
               'summaries': 'Summaries'
            };
            html += `<p><strong>ã‚µãƒ¼ãƒ“ã‚¹:</strong> ${serviceNames[formData.service]}</p>`;
         }
         if (formData.inquiry_type) {
            const inquiryTypes: { [key: string]: string } = {
               'general': 'ä¸€èˆ¬çš„ãªãŠå•ã„åˆã‚ã›',
               'technical': 'æŠ€è¡“çš„ãªå•é¡Œ',
               'feature': 'æ©Ÿèƒ½ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
               'business': 'ãƒ“ã‚¸ãƒã‚¹é–¢é€£',
               'account': 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–¢é€£',
               'other': 'ãã®ä»–'
            };
            html += `<p><strong>ãŠå•ã„åˆã‚ã›ç¨®åˆ¥:</strong> ${inquiryTypes[formData.inquiry_type]}</p>`;
         }

         summaryContent.innerHTML = html;
      }

      function submitForm() {
         if (!form || !formStatus) return;
         
         // Show loading state
         formStatus.className = 'form-status loading';
         
         // Disable submit button
         const submitButton = document.querySelector('.submit-button') as HTMLButtonElement;
         if (submitButton) {
            submitButton.disabled = true;
         }

         // Create FormData object
         const submitFormData = new FormData(form as HTMLFormElement);
         
         // Submit to Web3Forms
         fetch((form as HTMLFormElement).action || '/contact', {
            method: 'POST',
            body: submitFormData
         })
         .then(response => response.json())
         .then(data => {
            if (data.success) {
               formStatus.className = 'form-status success';
               (form as HTMLFormElement).reset();
               goToStep(1);
            } else {
               throw new Error('Submission failed');
            }
         })
         .catch(error => {
            console.error('Form submission error:', error);
            formStatus.className = 'form-status error';
         })
         .finally(() => {
            if (submitButton) {
               submitButton.disabled = false;
            }
         });
      }

      // Accessibility improvements
      function initializeAccessibility() {
         // Keyboard navigation for steps
         progressSteps.forEach((step, index) => {
            step.addEventListener('keydown', function(e) {
               const keyboardEvent = e as KeyboardEvent;
               if (keyboardEvent.key === 'Enter' || keyboardEvent.key === ' ') {
                  e.preventDefault();
                  const stepNumber = index + 1;
                  if (stepNumber <= currentStep || validateStepsUpTo(stepNumber - 1)) {
                     goToStep(stepNumber);
                  }
               }
            });
         });

         // Enhanced focus management
         steps.forEach(step => {
            step.addEventListener('transitionend', function(this: HTMLElement) {
               const stepElement = this;
               if (stepElement.classList.contains('active')) {
                  const firstInput = stepElement.querySelector('input, select, textarea') as HTMLElement;
                  if (firstInput) {
                     firstInput.focus();
                  }
               }
            });
         });
      }

      function validateStepsUpTo(stepNumber: number) {
         for (let i = 1; i <= stepNumber; i++) {
            const stepElement = document.querySelector(`.form-step[data-step="${i}"]`);
            if (!stepElement) continue;
            const requiredFields = stepElement.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!validateField(field as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement)) {
                   return false;
                }
             }
         }
         return true;
      }

      // Initialize accessibility features
      initializeAccessibility();
   });
</script>
