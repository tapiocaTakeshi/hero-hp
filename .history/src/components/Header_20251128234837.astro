---
import "../styles/style.css";
const { pathname } = Astro.url;
---
<header id="main-header" class="header">
  <div class="header-content">
    <div class="logo">
      <a href="/" aria-label="Hero HP ホームページ">
        <img class="icon" src="/He-ro_icon_white.png" alt="Hero Logo" />
      </a>
    </div>
    
    <nav class="main-nav" id="main-nav">
      <ul class="nav-list">
        <li><a href="/" class="nav-link <%= pathname === '/' ? 'active' : '' %>" data-page="home">Home</a></li>
        <li><a href="/riddle" class="nav-link <%= pathname === '/riddle' ? 'active' : '' %>" data-page="riddle">Riddle</a></li>
        <li><a href="/prompty" class="nav-link <%= pathname === '/prompty' ? 'active' : '' %>" data-page="prompty">Prompty</a></li>
        <li><a href="/playhub" class="nav-link <%= pathname === '/playhub' ? 'active' : '' %>" data-page="playhub">PlayHub</a></li>
        <li><a href="/summaries_app_description" class="nav-link <%= pathname === '/summaries_app_description' ? 'active' : '' %>" data-page="summaries">Summaries</a></li>
        <li><a href="/contact" class="nav-link <%= pathname === '/contact' ? 'active' : '' %>" data-page="contact">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const header = document.getElementById('main-header');
    let logoImg = document.querySelector<HTMLImageElement>('.logo .icon');
    const defaultLogoSrc = '/He-ro_icon.png';
    const whiteLogoSrc = '/He-ro_icon_white.png';

    const applyHeaderState = () => {
      if (!header) return;
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
        if (logoImg) logoImg.src = defaultLogoSrc;
      } else {
        header.classList.remove('scrolled');
        if (logoImg) logoImg.src = whiteLogoSrc;
      }
    };

    applyHeaderState();
    window.addEventListener('scroll', applyHeaderState);

    document.addEventListener('astro:page-load', () => {
        logoImg = document.querySelector<HTMLImageElement>('.logo .icon');
        applyHeaderState();
        const currentPath = window.location.pathname;
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === currentPath) {
                link.classList.add('active');
            }
        });
        if (currentPath === '/') {
            const homeLink = document.querySelector('.nav-link[data-page="home"]');
            if (homeLink) homeLink.classList.add('active');
        }
    });
  });
</script>

<style>
    .header {
        --header-inline-padding: var(--layout-padding-inline, 2.5rem);
        --header-inline-start: max(var(--header-inline-padding), env(safe-area-inset-left, 0px));
        --header-inline-end: max(var(--header-inline-padding), env(safe-area-inset-right, 0px));
        padding-top: clamp(0.85rem, 4vw, 1.6rem);
        padding-bottom: clamp(0.65rem, 3vw, 1.1rem);
        padding-left: var(--header-inline-start);
        padding-right: var(--header-inline-end);
        width: 100%;
        box-sizing: border-box;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
        transition: background-color 0.3s ease, border-bottom 0.3s ease, box-shadow 0.3s ease;
        background-color: rgba(8, 8, 8, 0.6);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
    }
    
    .header.scrolled {
        background-color: rgba(255, 255, 255, 0.92);
        border-bottom: 1px solid rgba(17, 17, 17, 0.08);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }
    
    .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
    }

    .logo a {
        display: flex;
        align-items: center;
    }

    .icon {
        width: 42px;
        height: auto;
        transition: transform 0.3s ease;
        filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.35));
    }
    
    .logo:hover .icon {
        transform: scale(1.05);
    }
    
    .nav-list {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .nav-link {
        color: #f5f5f5;
        text-decoration: none;
        font-weight: 500;
        position: relative;
        padding: 0.5rem 0;
        transition: color 0.3s ease;
        letter-spacing: 0.02em;
    }

    .nav-link::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background-color: currentColor;
        transition: width 0.3s ease;
    }

    .nav-link:hover::after,
    .nav-link.active::after {
        width: 100%;
    }

    .header.scrolled .nav-link {
        color: #111111;
    }

    .header.scrolled .nav-link::after {
        background-color: currentColor;
    }

    @media (max-width: 768px) {
        .header {
            --header-inline-padding: var(--layout-padding-inline, 1.25rem);
            padding-top: clamp(0.75rem, 3vw, 1.2rem);
            padding-bottom: clamp(0.55rem, 3vw, 0.9rem);
        }
        .header-content {
            flex-direction: column;
            gap: 1rem;
        }
        .nav-list {
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        .nav-link {
            font-size: 0.9rem;
        }
    }
</style>
